{% load static %}

<div class="trade-block">
  <div class="trade-header">
    <div class="trade-title">Сделки и история</div>

    <div class="ws-status-container">
      <div class="ws-status-item">
        <span class="ws-dot" id="ws-status-trade"></span>
        <span id="ws-status-trade-text">Отключено</span>
      </div>
    </div>
  </div>

  <div class="trade-topbar">
    <div class="live-price">
      <span class="label">Текущая цена</span>
      <span id="live-price" class="value">—</span>
    </div>

    <div class="fees">
      <span class="label">Комиссии</span>
      <span id="fees-value" class="value">—</span>
    </div>

    <div class="search-filter">
      <input id="filter-uuid" type="text" placeholder="UUID" />
      <select id="filter-side">
        <option value="">Сторона: все</option>
        <option value="buy">Лонг</option>
        <option value="sell">Шорт</option>
      </select>
      <select id="filter-status">
        <option value="">Статус: все</option>
        <option value="created">Создано</option>
        <option value="monitoring">Мониторинг</option>
        <option value="completed">Завершено</option>
        <option value="canceled">Отменено</option>
      </select>
      <button id="apply-filter" class="btn btn-primary">Применить</button>
      <button id="reset-filter" class="btn">Сброс</button>
    </div>
  </div>

  <div class="trade-tabs">
    <div class="tab-buttons">
      <button class="trade-tab-btn" data-tab="positions">Позиции</button>
      <button class="trade-tab-btn active" data-tab="orders">Ордеры</button>
    </div>

    <div class="trade-tab-content">

      <!-- ===========================================
           POSITIONS (6 колонок)
      ============================================ -->
      <div class="trade-panel" id="tab-positions">
        <div class="items-head table-grid table-grid-positions">
          <div class="col">Подробнее</div>
          <div class="col">Объём / Сумма</div>
          <div class="col">Сторона</div>
          <div class="col">UUID / Дата</div>
          <div class="col">Живёт</div>
          <div class="col">Статус</div>
        </div>

        <div id="positions-list" class="items-list"></div>

        <div class="pager">
          <button class="btn" id="pos-prev" disabled>« Назад</button>
          <div class="pager-info">
            <span id="pos-page">1</span> / <span id="pos-pages">1</span>
            <span class="muted">(<span id="pos-total">0</span>)</span>
          </div>
          <button class="btn" id="pos-next" disabled>Вперёд »</button>
        </div>
      </div>

      <!-- ===========================================
           ORDERS (7 колонок)
      ============================================ -->
      <div class="trade-panel active" id="tab-orders">
        <div class="items-head table-grid table-grid-orders">
          <div class="col">Подробнее</div>
          <div class="col">Объём / Сумма</div>
          <div class="col">Сторона</div>
          <div class="col">P&L</div>
          <div class="col">UUID / Дата</div>
          <div class="col">Живёт</div>
          <div class="col">Статус</div>
        </div>

        <div id="orders-list" class="items-list"></div>

        <div class="pager">
          <button class="btn" id="ord-prev" disabled>« Назад</button>
          <div class="pager-info">
            <span id="ord-page">1</span> / <span id="ord-pages">1</span>
            <span class="muted">(<span id="ord-total">0</span>)</span>
          </div>
          <button class="btn" id="ord-next" disabled>Вперёд »</button>
        </div>
      </div>

    </div>
  </div>
</div>

<!-- ===========================================
     MODAL TRADE DETAILS
=========================================== -->
<div id="trade-modal" class="modal">
  <div class="modal-dialog">
    <div class="modal-head">
      <div class="modal-title">Детали сделки</div>
      <div class="modal-price-wrap">
        <span class="modal-price">Текущая цена: <b id="md-live-price">—</b></span>
      </div>
      <button class="close" id="modal-close">✕</button>
    </div>

    <div class="modal-body">
      <div class="modal-section">
        <div class="kv">
          <button id="md-show-json" class="json-dot" title="Показать исходные данные"></button>

          <div><span>Тип:</span> <b id="md-type">—</b></div>
          <div><span>UUID:</span> <b id="md-uuid">—</b></div>
          <div><span>Символ:</span> <b id="md-symbol">—</b></div>
          <div><span>Сторона:</span> <b id="md-side">—</b></div>
          <div><span>Статус:</span> <b id="md-status">—</b></div>
          <div><span>Кол-во:</span> <b id="md-qty">—</b></div>
          <div><span>Цена:</span> <b id="md-price">—</b></div>
          <div><span>PnL:</span> <b id="md-pnl">—</b></div>
          <div><span>Курс закрытия:</span> <b id="md-close">—</b></div>
          <div><span>Создано:</span> <b id="md-created">—</b></div>
          <div><span>Живёт:</span> <b id="md-lifetime">—</b></div>
        </div>
      </div>

      <div class="modal-section modal-actions">
        <button class="btn btn-primary big" id="md-close-order-btn">
          Закрыть ордер
        </button>
      </div>

    </div>
  </div>
</div>

<!-- ===========================================
     JSON MODAL
=========================================== -->
<div id="json-modal" class="modal">
  <div class="modal-dialog json-dialog">
    <div class="modal-head">
      <div class="modal-title">Исходные данные</div>
      <button class="close" id="json-modal-close">✕</button>
    </div>

    <div class="modal-body">
      <pre id="json-modal-content" class="json-view"></pre>
    </div>
  </div>
</div>

<script type="module" src="{% static 'js/site/chart/trade.js' %}"></script>
